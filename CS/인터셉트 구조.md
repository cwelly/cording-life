# 인터셉트 구조

강의 번호: FrameWork
복습: No
작성일시: 2022년 10월 20일 오후 1:21

board2 에서 확인

write.jsp

```jsx
<form id="form-register" method="POST" enctype="multipart/form-data" action="">

...

<div class="form-group" align="left">
							<label for="upfile">파일:</label>
							<input type="file" class="form-control border" name="upfile" multiple="multiple">
							// 
						</div>
            <div class="col-auto text-center mt-3">
```

파일을 넘기는 부분이다.

이를 위해 파일을 보낼땐 명심해야하는 3가지 조건이 있다.

파일을 보낼 태그는 항상 input type 은 파일

form 의 메소드는 POST(파일로 넘길때 문자열 쿼리로는 넘길 수 없다.)

enctype =  "multipart/form-data"

```jsx
public String write(BoardDto boardDto, @RequestParam("upfile") MultipartFile[] files, HttpSession session,
			RedirectAttributes redirectAttributes) throws Exception {
```

여러개의 파일을 받을때는 MultipartFile[] files 을이용해 스프링이 받아오게한다.

## 인터셉트

인터셉트를 사용하기 위해 ,  인터셉터의 동작을 구현할 클래스는 항상 implements 를 해줘야 할 것이 있다.

```jsx
public class ConfirmInterceptor implements HandlerInterceptor{
```

위와 같은 인터페이스를 구현하는데 , 

인터셉트 타이밍에 따라서 오버라이딩할 메소드들이 다르다.

![Untitled](%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%B8%E1%84%90%E1%85%B3%20%E1%84%80%E1%85%AE%E1%84%8C%E1%85%A9%206bc518951a0a44099d194c0a3e28b691/Untitled.png)

위에선 안나왔지만 , preHandle 또한 구성원이다.

## 인터셉트를 위한 설정

```jsx
<!-- interceptor setting -->
	<interceptors>
		<interceptor>
			<!-- 주소를 기반으로 거르고 싶다? mapping 을 사용 -->
			<mapping path="/board/write"/>
			<mapping path="/board/view"/>
			<mapping path="/board/modify"/>
			<mapping path="/board/delete"/>
		</interceptor>
	</interceptors>
```

servlet-context.xml 에 위와 같이 설정을 해주어야 스프링이 DS와 컨트롤러 사이에서 불러올수 있게 한다.

여기서 끝이 아니라 , 이 인터셉트의 위치를 알려주는 객체가 필요하므로, bean을 하나 만들어야한다.

```jsx
<!-- interceptor setting -->
	<beans:bean id="confirmInterceptor" class="com.ssafy.interceptor.ConfirmInterceptor"></beans:bean>
	<interceptors>
		<interceptor>
			<!-- 주소를 기반으로 거르고 싶다? mapping 을 사용 -->
			<mapping path="/board/write"/>
			<mapping path="/board/view"/>
			<mapping path="/board/modify"/>
			<mapping path="/board/delete"/>
			
			<beans:ref bean="confirmInterceptor"/>
		</interceptor>
	</interceptors>
```